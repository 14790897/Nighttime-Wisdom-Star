version: '3'
services:
  web:
    build:
      context: .
      dockerfile: Dockerfile.web
    image: 14790897/nighttime-wisdom-star-2:latest
    pull_policy: if_not_present
    ports:
      - "5001:5000"
    depends_on:
      - redis
      - pandora

  pandora:
    build:
      context: .
      dockerfile: Dockerfile.pandora
    image: pengzhile/pandora
    pull_policy: if_not_present
    environment:
      - PANDORA_ACCESS_TOKEN=${PANDORA_ACCESS_TOKEN}
      - PANDORA_SERVER=${PANDORA_SERVER}
    ports:
      - "8008:8008"

  redis:
    image: "redis:alpine"
    volumes:
      - /mydata:/data
